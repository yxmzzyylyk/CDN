"use strict";function asyncGeneratorStep(e,t,a,n,l,o,r){try{var c=e[o](r),i=c.value}catch(e){return void a(e)}c.done?t(i):Promise.resolve(i).then(n,l)}function _asyncToGenerator(c){return function(){var e=this,r=arguments;return new Promise(function(t,a){var n=c.apply(e,r);function l(e){asyncGeneratorStep(n,t,a,l,o,"next",e)}function o(e){asyncGeneratorStep(n,t,a,l,o,"throw",e)}l(void 0)})}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _wp$element=wp.element,RawHTML=_wp$element.RawHTML,createElement=_wp$element.createElement,Component=_wp$element.Component,_wp$blocks=wp.blocks,registerBlockType=_wp$blocks.registerBlockType,createBlock=_wp$blocks.createBlock,_ref=wp.blockEditor?wp.blockEditor:wp.editor,InspectorControls=_ref.InspectorControls,BlockControls=_ref.BlockControls,RichText=_ref.RichText,InnerBlocks=_ref.InnerBlocks,_wp$components=wp.components,Panel=_wp$components.Panel,PanelBody=_wp$components.PanelBody,BaseControl=_wp$components.BaseControl,TextareaControl=_wp$components.TextareaControl,TextControl=_wp$components.TextControl,ToggleControl=_wp$components.ToggleControl,Placeholder=_wp$components.Placeholder,SelectControl=_wp$components.SelectControl,RadioControl=_wp$components.RadioControl,Dashicon=_wp$components.Dashicon,Toolbar=_wp$components.Toolbar,Button=_wp$components.Button;!function(){var e=wp.element.createElement,t=wp.components.SVG,a=e("path",{d:"M1013.279 489.694c-0.95-28.585-4.03-56.951-9.918-84.931-21.925-104.164-70.769-193.81-149.27-265.666C730.099 25.604 583.818-16.716 418.535 12.297 304.454 32.32 209.16 88.362 132.89 175.516 59.99 258.823 19.54 356.3 10.434 466.588c-3.906 47.3-0.883 94.31 8.915 140.808C42.28 716.216 95.173 807.94 178.347 881.545c90.304 79.91 196.42 121.4 316.897 126.183l31.602 0.013c26.434-0.854 52.715-3.447 78.634-8.627 122.905-24.566 223.79-85.739 301.287-184.186 67.664-85.954 102.442-184.355 106.523-293.631-0.001-10.535-0.004-21.07-0.011-31.603z m-553.53 114.782a70040.09 70040.09 0 0 1-57.111 59.913c-14.044 14.71-30.733 23.622-51.592 22.278-15.641-1.008-29.554-7.301-42.67-15.519-19.7-12.335-37.046-27.659-53.648-43.708A24485.24 24485.24 0 0 1 102.4 478.88c-34.285-33.723-36.605-77.93-6.999-115.832 18.823-24.099 43.697-35.597 71.17-36.704 22.924 0.324 40.568 6.779 55.422 20.88 33.114 31.44 66.423 62.676 99.65 93.998 3.262 3.073 6.76 5.838 10.655 8.058 11.961 6.815 21 5.738 31.264-3.449 34.752-31.104 68.228-63.58 102.3-95.414 13.897-12.985 28.972-23.38 48.157-26.365 37.053-5.766 66.394 7.114 87.621 37.695 22.734 32.75 18.44 71.23-10.156 102.562-43.233 47.362-87.521 93.731-131.736 140.167z m440.937-138.228c-12.6 19.93-27.502 38.123-43.56 55.248-47.843 51.016-93.632 103.852-139.508 156.605-21.543 24.77-56.224 33.72-89.726 22.109-30.88-10.703-52.958-30.902-64.005-62.07-12.873-36.33-12.562-72.506 2.56-108.206 2.676-6.317 5.905-12.43 11.545-18.332 0 3.18-0.01 5.22 0 7.257 0.048 10.29 5.47 18.419 14.827 22.236 9.826 4.01 19.429 2.28 26.528-5.596 11.563-12.844 22.645-26.117 34.143-39.018 28.686-32.193 57.73-64.069 86.132-96.51 10.747-12.273 21.183-24.674 33.346-35.684 30.821-27.896 74.582-20.312 101.224-3.188 24.119 15.5 37.49 38.367 38.337 67.426 0.397 13.682-4.56 26.197-11.843 37.723z",fill:"#008ED6"}),n=e(t,{xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 1024 1024"},a);wp.blocks.updateCategory("wpcom",{icon:n})}(),registerBlockType("wpcom/baidu-map",{title:"百度地图",description:"可添加百度地图到文章内容",icon:"location-alt",category:"wpcom",attributes:{pos:{type:"string",default:"116.403963,39.915119"},title:{type:"string",default:""},address:{type:"string",default:""},height:{type:"number",default:300},scroll:{type:"boolean",default:!1}},edit:function(e){var t=e.attributes,a=t.title,n=t.address,l=t.pos,o=t.height,r=t.scroll,c=e.setAttributes;return[React.createElement(Placeholder,{icon:"location-alt",label:"百度地图"},React.createElement("div",{className:"wpcom-blocks-panel"},React.createElement(TextControl,{id:"pos",label:"坐标",placeholder:"请填写位置坐标",help:"位置坐标信息，拾取地址：http://api.map.baidu.com/lbsapi/getpoint/index.html",value:l,onChange:function(e){return c({pos:e})}}),React.createElement(TextControl,{id:"title",label:"标题",placeholder:"请填写地图标题",help:"例如公司名称",value:a,onChange:function(e){return c({title:e})}}),React.createElement(TextareaControl,{id:"address",label:"地址",placeholder:"请填写地图地址",rows:"2",help:"例如公司地址",value:n,onChange:function(e){return c({address:e})}}),React.createElement(TextControl,{id:"height",label:"高度",type:"number",placeholder:"请填写地图高度",help:"地图显示高度，单位px，无需带单位",value:o,onChange:function(e){return c({height:e})}}),React.createElement(ToggleControl,{id:"scroll",label:"滚轮缩放",help:"开启后可以使用鼠标滚轮放大缩小地图",checked:r,onChange:function(e){return c({scroll:e})}})))]},save:function(e){var t=e.attributes,a=t.title,n=t.address,l='[map title="'+a+'" pos="'+t.pos+'" height="'+t.height+'" scroll="'+t.scroll+'"]'+n+"[/map]";return React.createElement(RawHTML,null,l)}}),registerBlockType("wpcom/google-map",{title:"谷歌地图",description:"可添加谷歌地图到文章内容",icon:"location",category:"wpcom",attributes:{pos:{type:"string",default:"39.908911, 116.397475"},title:{type:"string",default:""},address:{type:"string",default:""},height:{type:"number",default:300},scroll:{type:"boolean",default:!1}},edit:function(e){var t=e.attributes,a=t.title,n=t.address,l=t.pos,o=t.height,r=t.scroll,c=e.setAttributes;return[React.createElement(Placeholder,{icon:"location-alt",label:"谷歌地图"},React.createElement("div",{className:"wpcom-blocks-panel"},React.createElement(TextControl,{id:"pos",label:"坐标",placeholder:"请填写位置坐标",help:"位置坐标信息，拾取地址：http://www.gpsspg.com/maps.htm",value:l,onChange:function(e){return c({pos:e})}}),React.createElement(TextControl,{id:"title",label:"标题",placeholder:"请填写地图标题",help:"例如公司名称",value:a,onChange:function(e){return c({title:e})}}),React.createElement(TextareaControl,{id:"address",label:"地址",placeholder:"请填写地图地址",rows:"2",help:"例如公司地址",value:n,onChange:function(e){return c({address:e})}}),React.createElement(TextControl,{id:"height",label:"高度",type:"number",placeholder:"请填写地图高度",help:"地图显示高度，单位px，无需带单位",value:o,onChange:function(e){return c({height:e})}}),React.createElement(ToggleControl,{id:"scroll",label:"滚轮缩放",help:"开启后可以使用鼠标滚轮放大缩小地图",checked:r,onChange:function(e){return c({scroll:e})}})))]},save:function(e){var t=e.attributes,a=t.title,n=t.address,l='[map title="'+a+'" pos="'+t.pos+'" height="'+t.height+'" scroll="'+t.scroll+'" type="1"]'+n+"[/map]";return React.createElement(RawHTML,null,l)}}),registerBlockType("wpcom/video-code",{title:"视频代码",description:"可添加第三方视频网站通用分享代码",icon:"video-alt3",category:"wpcom",attributes:{code:{type:"string",default:""},width:{type:"string",default:""},height:{type:"string",default:""},center:{type:"boolean",default:!0}},edit:function(){function a(e){var t;return _classCallCheck(this,a),(t=_possibleConstructorReturn(this,_getPrototypeOf(a).apply(this,arguments))).props=e,t.state={isEdit:""===e.attributes.code},t}return _inherits(a,Component),_createClass(a,[{key:"editStatus",value:function(e){this.setState({isEdit:e})}},{key:"get_html",value:function(){var e=this.props.attributes,t=e.code,a=e.width,n=e.height,l=t,o='<div class="video-code-inner'+(e.center?" center":"")+'"'+(a?' style="width:'+a+'px"':"")+">";return a&&(l=l.replace(/\s+width=(['"])?([^'"\s]+)(['"])?/i,' width="'+a+'"')),n&&(l=l.replace(/\s+height=(['"])?([^'"\s]+)(['"])?/i,' height="'+n+'"')),l.match(/\s+width=/i)||(l=l.replace(/<([^\s]+)\s+/i,'<$1 width="'+a+'" ')),l.match(/\s+height=/i)||(l=l.replace(/<([^\s]+)\s+/i,'<$1 height="'+n+'" ')),o+=l,o+="</div>"}},{key:"render",value:function(){var e=this.props,t=e.attributes,a=t.code,n=t.width,l=t.height,o=t.center,r=e.setAttributes,c=this.state.isEdit;return[React.createElement(BlockControls,null,React.createElement(Toolbar,null,!c&&React.createElement(Button,{icon:"edit",onClick:this.editStatus.bind(this,!0)}))),React.createElement(Placeholder,{className:c?"":"wpcom-blocks-hide",icon:"video-alt3",label:"视频代码"},c&&React.createElement("div",{className:"wpcom-blocks-panel"},React.createElement(TextareaControl,{id:"address",label:"代码",placeholder:"请填写视频代码",rows:"3",help:"第三方网站视频代码",value:a,onChange:function(e){return r({code:e})}}),React.createElement(TextControl,{id:"width",label:"宽度",placeholder:"请填写视频宽度",help:"可选，视频显示宽度，单位px，无需带单位，如超过可视区宽度会自动100%适应",value:n,onChange:function(e){return r({width:e})}}),React.createElement(TextControl,{id:"height",label:"高度",placeholder:"请填写视频高度",help:"可选，视频显示高度，单位px，无需带单位",value:l,onChange:function(e){return r({height:e})}}),React.createElement(ToggleControl,{id:"center",label:"居中",help:"视频是否居中显示",checked:o,onChange:function(e){return r({center:e})}}),React.createElement(Button,{isPrimary:!0,onClick:this.editStatus.bind(this,!1),className:"wpcom-components-button"},"提交预览"))),React.createElement("div",null,!c&&React.createElement(RawHTML,null,this.get_html()))]}}]),a}(),save:function(e){var t=e.attributes,a=t.code,n=t.width,l=t.height,o=t.center,r=a;n&&(r=r.replace(/\s+width=(['"])?([^'"\s]+)(['"])?/i,' width="'+n+'"')),l&&(r=r.replace(/\s+height=(['"])?([^'"\s]+)(['"])?/i,' height="'+l+'"')),r.match(/\s+height=/i)||(r=r.replace(/<([^\s]+)\s+/i,'<$1 height="'+l+'" ')),r.match(/\s+width=/i)||(r=r.replace(/<([^\s]+)\s+/i,'<$1 width="'+n+'" '));var c='<div class="video-code-inner'+(o?" center":"")+'">'+r+"</div>";return React.createElement(RawHTML,null,c)}}),registerBlockType("wpcom/alert",{title:"提示信息",description:"添加此区块可显示一段提示信息",icon:"megaphone",category:"wpcom",attributes:{content:{type:"html",source:"children",selector:"p",default:[]},type:{type:"string",default:"default"},icon:{type:"string",default:""},icon_size:{type:"string",default:"0"}},edit:function(e){var t=e.attributes,a=e.setAttributes,n=t.content,l=t.type,o=t.icon,r=t.icon_size;return[React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:"提示设置"},React.createElement(SelectControl,{id:"type",label:"风格",placeholder:"请选择提示风格",help:"提示面板显示风格",value:l,onChange:function(e){return a({type:e})},options:[{label:"默认",value:"default"},{label:"成功",value:"success"},{label:"提示",value:"info"},{label:"警告",value:"warning"},{label:"危险",value:"danger"}]}),React.createElement(TextControl,{id:"icon",label:"图标",placeholder:"请填写图标名称",help:"",value:o,onChange:function(e){return a({icon:e})}}),React.createElement("p",{className:"wpcom-inspector-html-help"},"图标选择请",React.createElement("a",{href:"https://fontawesome.com/v4.7.0/icons/",target:"_blank"},"点击此处选择")),React.createElement(RadioControl,{id:"icon_size",label:"图标尺寸",placeholder:"请选择图标尺寸",help:"提示面板图标尺寸",selected:r,onChange:function(e){return a({icon_size:e})},options:[{label:"小图标",value:"0"},{label:"大图标",value:"1"}]}))),React.createElement("div",{className:"wpcom-blocks-alert alert alert-"+l+("1"==r?" alert-fa-lg":""),role:"alert"},o?React.createElement("i",{className:"fa fa-"+o+("1"==r?" fa-lg":"")}):"",React.createElement(RichText,{key:"editable",tagName:"div",value:n,onChange:function(e){return a({content:e})}}))]},save:function(e){var t=e.attributes,a=t.content,n=t.type,l=t.icon,o=t.icon_size;return React.createElement("div",null,'[alert size="',o,'" icon="',l,'" type="',n,'"]',React.createElement("p",null,a),"[/alert]")}}),registerBlockType("wpcom/panel",{title:"面板",description:"提示面板信息区块",icon:"info",category:"wpcom",attributes:{type:{type:"string",default:"default"},title:{type:"string",default:"面板标题"},icon:{type:"string",default:""}},edit:function(e){var t=e.attributes,a=e.setAttributes,n=t.type,l=t.icon,o=t.title;return[React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:"面板设置"},React.createElement(SelectControl,{id:"type",label:"风格",placeholder:"请选择面板风格",help:"面板显示风格",value:n,onChange:function(e){return a({type:e})},options:[{label:"默认",value:"default"},{label:"成功",value:"success"},{label:"提示",value:"info"},{label:"警告",value:"warning"},{label:"危险",value:"danger"}]}),React.createElement(TextControl,{id:"title",label:"标题",placeholder:"请填写面板标题",help:"",value:o,onChange:function(e){return a({title:e})}}),React.createElement(TextControl,{id:"icon",label:"图标",placeholder:"请填写图标名称",help:"",value:l,onChange:function(e){return a({icon:e})}}),React.createElement("p",{className:"wpcom-inspector-html-help"},"图标选择请",React.createElement("a",{href:"https://fontawesome.com/v4.7.0/icons/",target:"_blank"},"点击此处选择")))),React.createElement("div",{className:"wpcom-blocks-panel panel panel-"+n},React.createElement("div",{className:"panel-heading"},React.createElement("h3",{className:"panel-title"},l?React.createElement("i",{className:"fa fa-"+l}):""," ",o," ")),React.createElement("div",{className:"panel-body"}," ",React.createElement(InnerBlocks,null)," "))]},save:function(e){var t=e.attributes,a=t.type,n=t.icon,l=t.title;return React.createElement("div",null,' [panel type="',a,'" title="',l,'" icon="',n,'"] ',React.createElement(InnerBlocks.Content,null)," [/panel] ")}}),registerBlockType("wpcom/acco",{title:"选项卡",description:"单个选项卡，用于手风琴切换区块",icon:"archive",category:"common",parent:["wpcom/accordion"],attributes:{title:{type:"string",default:"请设置标题"},id:{type:"number",default:0},index:{type:"number"},first:{type:"boolean",default:!1}},edit:function(){function a(e){var t;return _classCallCheck(this,a),(t=_possibleConstructorReturn(this,_getPrototypeOf(a).apply(this,arguments))).props=e,t}return _inherits(a,Component),_createClass(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.clientId,a=e.setAttributes,n=wp.data.select,l=jQuery("#block-"+t).closest(".wp-block-wpcom-accordion").closest(".editor-block-list__block-edit,.wp-block").data("block"),o=n("core/block-editor").getBlocksByClientId(l)[0],r=o.innerBlocks;if(r)for(var c=0;c<r.length;c++)if(t===r[c].clientId){var i=0;r[c].attributes.id||(i=1),a({id:o.attributes.id,index:c,first:0===c}),jQuery("#accordion-"+o.attributes.id).off("click.acc").on("click.acc",".panel-title a",function(e){e.preventDefault(),jQuery(jQuery(this).attr("href")).toggleClass("in")}),i&&jQuery("#block-"+r[c].clientId).find(".panel-title a").trigger("click")}}},{key:"render",value:function(){var e=this.props,t=e.attributes,a=e.setAttributes,n=t.title,l=t.id,o=t.index;return[React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:"选项设置"},React.createElement(TextControl,{id:"title",label:"标题",placeholder:"请填写标题",help:"",value:n,onChange:function(e){return a({title:e})}}))),React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading",id:"heading-"+l+"-"+o},React.createElement("h4",{className:"panel-title"},React.createElement("a",{href:"#accordion-"+l+"-"+o},n))),React.createElement("div",{id:"accordion-"+l+"-"+o,className:"panel-collapse collapse"},React.createElement("div",{className:"panel-body"},React.createElement(InnerBlocks,null))))]}}]),a}(),save:function(e){var t=e.attributes,a=t.title,n=t.id,l=t.index,o=t.first;return React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading",id:"heading-"+n+"-"+l},React.createElement("h4",{className:"panel-title"},React.createElement("a",{role:"button","data-toggle":"collapse","data-parent":"#accordion-"+n,href:"#accordion-"+n+"-"+l},a))),React.createElement("div",{id:"accordion-"+n+"-"+l,className:"panel-collapse collapse"+(o?" in":"")},React.createElement("div",{className:"panel-body"},React.createElement(InnerBlocks.Content,null))))}}),registerBlockType("wpcom/accordion",{title:"手风琴",description:"手风琴切换效果",icon:"archive",category:"wpcom",attributes:{id:{type:"number",default:0}},edit:function(){function a(e){var t;return _classCallCheck(this,a),(t=_possibleConstructorReturn(this,_getPrototypeOf(a).apply(this,arguments))).props=e,t}return _inherits(a,Component),_createClass(a,[{key:"render",value:function(){var e=this.props.attributes;return[React.createElement("div",{className:"wp-block-wpcom-accordion panel-group",id:"accordion-"+e.id},React.createElement(InnerBlocks,{allowedBlocks:["wpcom/acco"]}))]}}]),a}(),save:function(e){var t=e.attributes.id;return React.createElement("div",{className:"panel-group",id:"accordion-"+t}," ",React.createElement(InnerBlocks.Content,null)," ")}}),registerBlockType("wpcom/tabs",{title:"选项卡切换",description:"可切换的选项卡",icon:"schedule",category:"wpcom",attributes:{type:{type:"string",default:"0"},title:{type:"array"},id:{type:"number",default:0}},edit:function(){function a(e){var t;return _classCallCheck(this,a),t=_possibleConstructorReturn(this,_getPrototypeOf(a).apply(this,arguments)),e.attributes.title=e.attributes.title&&"string"==typeof e.attributes.title?e.attributes.title.split("||"):e.attributes.title,t.props=e,t}return _inherits(a,Component),_createClass(a,[{key:"titleUpdate",value:function(e){var t=this.props,a=t.attributes,n=t.setAttributes,l=a.title,o=jQuery(e.target);l[o.parent().index()]=o.text(),n({title:l})}},{key:"tabRemove",value:function(e){e.stopPropagation();var t=this.props,a=t.attributes,n=t.setAttributes,l=jQuery(e.target).closest("li"),o=l.find("> a").attr("href"),r=jQuery(o);if(r.length){var c=r.closest(".wp-block").data("block");wp.data.dispatch("core/block-editor").removeBlock(c).then(function(){var e=Object.assign([],a.title);e.splice(l.index(),1),n({title:e})})}}},{key:"insertBlock",value:function(){var e=this.props.clientId,t=wp.blocks.createBlock("wpcom/tab");wp.data.dispatch("core/block-editor").insertBlock(t,void 0,e)}},{key:"tabClick",value:function(e){e.preventDefault();var t=jQuery(e.target).closest("li");t.parent().find("li").removeClass("active"),t.addClass("active");var a=t.find("> a").attr("href");t.closest(".wpcom-blocks-tabs").find(".tab-content .tab-pane").closest(".wp-block").attr("tab-show","false"),jQuery(a).closest(".wp-block").attr("tab-show","true")}},{key:"appender",value:function(){return!1}},{key:"render",value:function(){var e=this.props,t=e.attributes,a=e.setAttributes;t.id||a({id:(new Date).valueOf()});var n=t.type,l=t.id,o=this,r=t.title&&"string"==typeof t.title?t.title.split("||"):t.title,c=r?r.map(function(e,t){return React.createElement("li",{className:0===t?"active":"",onClick:o.tabClick.bind(o)},React.createElement("a",{href:"#tabs-"+l+"-"+t,contenteditable:"true",onBlur:o.titleUpdate.bind(o)},e),React.createElement("i",{className:"close",onClick:o.tabRemove.bind(o)},React.createElement(Dashicon,{size:"14",icon:"no-alt",label:"删除"})))}):"";return[React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:"选项卡设置"},React.createElement(SelectControl,{id:"type",label:"布局",placeholder:"请选择选项卡布局",help:"",value:n,onChange:function(e){return a({type:e})},options:[{label:"上下布局",value:"0"},{label:"左右布局",value:"1"}]}))),React.createElement("div",{className:"wpcom-blocks-tabs tabs"+("1"===n?" tabs-horizontal":"")},React.createElement("ul",{className:"nav nav-tabs"},c,React.createElement("li",{className:"inserter"},"0"===n&&React.createElement(Button,{icon:"insert",label:"添加选项卡",className:"tab-inserter",onClick:this.insertBlock.bind(this)}),"1"===n&&React.createElement(InnerBlocks.ButtonBlockAppender,{className:"tab-inserter"}))),React.createElement("div",{className:"tab-wrap"},React.createElement("div",{className:"tab-content"},React.createElement(InnerBlocks,{allowedBlocks:["wpcom/tab"],renderAppender:this.appender}))))]}}]),a}(),save:function(e){var t=e.attributes,a=t.type,n=t.id,l=e.attributes.title&&"object"===_typeof(e.attributes.title)?e.attributes.title.join("||"):e.attributes.title;return React.createElement("div",null,'[tabs type="',a,'" title="',l,'" id="',n,'"] ',React.createElement(InnerBlocks.Content,null)," [/tabs]")}}),registerBlockType("wpcom/tab",{title:"选项卡",description:"单个选项卡，用于选项卡切换区块",icon:"schedule",category:"common",parent:["wpcom/tabs"],attributes:{id:{type:"number",default:0},index:{type:"number"},first:{type:"boolean",default:!1}},edit:function(){function a(e){var t;return _classCallCheck(this,a),(t=_possibleConstructorReturn(this,_getPrototypeOf(a).apply(this,arguments))).props=e,t}return _inherits(a,Component),_createClass(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.clientId,l=e.attributes,o=e.setAttributes,a=wp.data.select,r=jQuery("#block-"+t).closest(".wp-block-wpcom-tabs,.wpcom-blocks-tabs"),c=r.closest(".editor-block-list__block-edit,.wp-block").data("block"),i=a("core/block-editor").getBlocksByClientId(c)[0],n=i.innerBlocks;if(n)for(var s=0;s<n.length;s++)t===n[s].clientId&&function(e){var t=0;if(l.id||(t=1),o({id:i.attributes.id,index:e,first:0===e}),0===e&&r.find(".nav-tabs>li").eq(e).trigger("click"),t){var a=r.find(".nav-tabs>li").eq(e);if(!a||a.hasClass("inserter")){var n=Object.assign([],i.attributes.title);n.push("新标签"),wp.data.dispatch("core/block-editor").updateBlockAttributes(c,{title:n}).then(function(){setTimeout(function(){r.find(".nav-tabs>li").eq(e).trigger("click")},50)})}}}(s)}},{key:"componentWillUnmount",value:function(){var e=this.props.clientId,t=wp.data.select,l=jQuery("#block-"+e).closest(".wp-block-wpcom-tabs,.wpcom-blocks-tabs"),a=l.closest(".editor-block-list__block-edit,.wp-block").data("block"),o=t("core/block-editor").getBlocksByClientId(a)[0].innerBlocks;o&&setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(t<o.length)return e.next=4,wp.data.dispatch("core/block-editor").updateBlockAttributes(o[t].clientId,{index:t});e.next=7;break;case 4:t++,e.next=1;break;case 7:((a=l.find(".nav-tabs>.active").index())<0||a===o.length)&&(n=a<0?0:a-1,l.find(".nav-tabs>li").eq(n).trigger("click"));case 9:case"end":return e.stop()}},e,this)})),20)}},{key:"render",value:function(){var e=this.props.attributes,t=e.id,a=e.index;return React.createElement("div",{className:"tab-pane",id:"tabs-"+t+"-"+a},React.createElement(InnerBlocks,null))}}]),a}(),save:function(e){var t=e.attributes,a=t.id,n=t.index,l=t.first;return React.createElement("div",{className:"tab-pane"+(l?" active":""),id:"tabs-"+a+"-"+n},React.createElement(InnerBlocks.Content,null))}});var checked=!0;wp.data.subscribe(function(e){if("undefined"!=typeof _panel_options&&_panel_options["theme-settings"]&&"1"==_panel_options["theme-settings"].save_remote_img){var t=wp.data.select("core/editor"),a=t.isSavingPost(),n=t.isAutosavingPost();if(a&&!n)checked=!1;else if(!checked){checked=!0;try{var l=t.getCurrentPost();if(l&&l.content&&"publish"===t.getEditedPostAttribute("status")){var o=wp.blocks.parse(l.content);o&&wp.data.dispatch("core/editor").editPost({blocks:o})}}catch(e){console.log(e)}}}});